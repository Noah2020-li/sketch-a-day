var Dw={};(function(c){const e={LIBRARY:"p5.EasyCam",VERSION:"1.0.4",AUTHOR:"Thomas Diewald",SOURCE:"https://github.com/diwi/p5.EasyCam",toString:function(){return this.LIBRARY+" v"+this.VERSION+" by "+this.AUTHOR+" ("+this.SOURCE+")"}};var f=class{constructor(n,o){if(!(n instanceof p5.RendererGL))return void console.log("renderer needs to be an instance of p5.RendererGL");o=o||{},o.distance===void 0&&(o.distance=500),o.center===void 0&&(o.center=[0,0,0]),o.rotation===void 0&&(o.rotation=j.identity()),o.viewport===void 0&&(o.viewport=[0,0,n.width,n.height]),this.INFO=e,this.setCanvas(n);var p=this;this.cam=p,this.LOOK=[0,0,1],this.UP=[0,1,0],this.AXIS=new function(){this.YAW=1,this.PITCH=2,this.ROLL=4,this.ALL=this.YAW|this.PITCH|this.ROLL},this.SHIFT_CONSTRAINT=0,this.FIXED_CONSTRAINT=0,this.DRAG_CONSTRAINT=0,this.scale_rotation=1e-3,this.scale_pan=2e-4,this.scale_zoom=1e-3,this.scale_zoomwheel=20,this.default_interpolation_time=300,this.distance_min_limit=0.01,this.distance_min=1,this.distance_max=Number.MAX_VALUE,this.state={distance:o.distance,center:o.center.slice(),rotation:o.rotation.slice(),copy:function(q){return q=q||{},q.distance=this.distance,q.center=this.center.slice(),q.rotation=this.rotation.slice(),q}},this.state_reset=this.state.copy(),this.state_pushed=this.state.copy(),this.viewport=o.viewport.slice(),this.mouse={cam:p,curr:[0,0],prev:[0,0],dist:[0,0],mwheel:0,isPressed:!1,button:-1,mouseDragLeft:p.mouseDragRotate,mouseDragCenter:p.mouseDragPan,mouseDragRight:p.mouseDragZoom,mouseWheelAction:p.mouseWheelZoom,insideViewport:function(q,r){var u=p.viewport[0],v=u+p.viewport[2],A=p.viewport[1],B=A+p.viewport[3];return q>u&&q<v&&r>A&&r<B},solveConstraint:function(){var q=this.dist[0],r=this.dist[1];this.shiftKey&&!p.SHIFT_CONSTRAINT&&1<Math.abs(q-r)&&(p.SHIFT_CONSTRAINT=Math.abs(q)>Math.abs(r)?p.AXIS.YAW:p.AXIS.PITCH),p.DRAG_CONSTRAINT=p.AXIS.ALL,p.FIXED_CONSTRAINT&&(p.DRAG_CONSTRAINT=p.FIXED_CONSTRAINT),p.SHIFT_CONSTRAINT&&(p.DRAG_CONSTRAINT=p.SHIFT_CONSTRAINT)},mousedown:function(q){var r=p.mouse;r.winref=q.view;var u=q.x,v=q.y;r.insideViewport(u,v)&&(r.curr[0]=r.prev[0]=u,r.curr[1]=r.prev[1]=v,r.dist[0]=0,r.dist[1]=0,r.isPressed=!0,r.button=q.button,p.SHIFT_CONSTRAINT=0)},update:function(){var q=p.mouse;q.isPressed&&(q.prev[0]=q.curr[0],q.prev[1]=q.curr[1],q.curr[0]=p.P5.mouseX,q.curr[1]=p.P5.mouseY,q.dist[0]=-(q.curr[0]-q.prev[0]),q.dist[1]=-(q.curr[1]-q.prev[1]),q.solveConstraint(),0===q.button&&q.mouseDragLeft&&q.mouseDragLeft(),1===q.button&&q.mouseDragCenter&&q.mouseDragCenter(),2===q.button&&q.mouseDragRight&&q.mouseDragRight())},mouseup:function(){p.mouse.isPressed=!1,p.SHIFT_CONSTRAINT=0},dblclick:function(q){var r=q.x,u=q.y;p.mouse.insideViewport(r,u)&&p.reset()},wheel:function(q){var r=q.x,u=q.y,v=p.mouse;v.insideViewport(r,u)&&(v.mwheel=0.01*q.deltaY,v.mouseWheelAction&&v.mouseWheelAction())},shiftKey:!1,keydown:function(q){var r=p.mouse;r.shiftKey||(r.shiftKey=16===q.keyCode)},keyup:function(q){var r=p.mouse;r.shiftKey&&(r.shiftKey=16!==q.keyCode,!r.shiftKey&&(p.SHIFT_CONSTRAINT=0))}},this.attachMouseListeners(),this.auto_update=!0,p5.prototype.registerMethod("pre",function(){p.auto_update&&p.update()}),this.dampedZoom=new g(this,function(q){p.zoom(q*p.getZoomMult())}),this.dampedPanX=new g(this,function(q){p.panX(q*p.getPanMult())}),this.dampedPanY=new g(this,function(q){p.panY(q*p.getPanMult())}),this.dampedRotX=new g(this,function(q){p.rotateX(q*p.getRotationMult())}),this.dampedRotY=new g(this,function(q){p.rotateY(q*p.getRotationMult())}),this.dampedRotZ=new g(this,function(q){p.rotateZ(q*p.getRotationMult())}),this.timedRot=new i(this,this.setInterpolatedRotation),this.timedPan=new i(this,this.setInterpolatedCenter),this.timedzoom=new i(this,this.setInterpolatedDistance)}setCanvas(n){n instanceof p5.RendererGL?(this.renderer=n,this.graphics=n._pInst instanceof p5?n:n._pInst,this.P5=this.graphics._pInst):(this.graphics=void 0,this.renderer=void 0)}getCanvas(){return this.renderer}attachListener(n,o,p,q){n&&n!==p.el&&(this.detachListener(p),p.el=n,p.ev=o,p.op=q,p.el.addEventListener(p.ev,p,p.op))}detachListener(n){n.el&&(n.el.removeEventListener(n.ev,n,n.op),n.el=void 0)}attachMouseListeners(n){var o=this.cam,p=o.mouse;if(n=n||o.renderer,n){var q={passive:!0},r=n.elt;o.attachListener(r,"mousedown",p.mousedown,q),o.attachListener(r,"mouseup",p.mouseup,q),o.attachListener(r,"dblclick",p.dblclick,q),o.attachListener(r,"wheel",p.wheel,q),o.attachListener(window,"keydown",p.keydown,q),o.attachListener(window,"keyup",p.keyup,q)}}removeMouseListeners(){var n=this.cam,o=n.mouse;n.detachListener(o.mousedown),n.detachListener(o.mouseup),n.detachListener(o.dblclick),n.detachListener(o.wheel),n.detachListener(o.keydown),n.detachListener(o.keyup)}dispose(){removeMouseListeners()}getAutoUpdate(){return this.auto_update}setAutoUpdate(n){this.auto_update=n}setViewport(n){this.viewport=n.slice()}getViewport(){return this.viewport}update(){var n=this.cam,o=n.mouse;o.update();var p=!1;p|=n.dampedZoom.update(),p|=n.dampedPanX.update(),p|=n.dampedPanY.update(),p|=n.dampedRotX.update(),p|=n.dampedRotY.update(),p|=n.dampedRotZ.update(),p?(n.timedRot.stop(),n.timedPan.stop(),n.timedzoom.stop()):(n.timedRot.update(),n.timedPan.update(),n.timedzoom.update()),n.apply()}apply(n){var o=this.cam;n=n||o.renderer,n&&(this.camEYE=this.getPosition(this.camEYE),this.camLAT=this.getCenter(this.camLAT),this.camRUP=this.getUpVector(this.camRUP),n.camera(this.camEYE[0],this.camEYE[1],this.camEYE[2],this.camLAT[0],this.camLAT[1],this.camLAT[2],this.camRUP[0],this.camRUP[1],this.camRUP[2]))}mouseWheelZoom(){var n=this,o=this.cam;o.dampedZoom.addForce(n.mwheel*o.scale_zoomwheel)}mouseDragZoom(){var n=this,o=this.cam;o.dampedZoom.addForce(-n.dist[1])}mouseDragPan(){var n=this,o=this.cam;o.dampedPanX.addForce(o.DRAG_CONSTRAINT&o.AXIS.YAW?n.dist[0]:0),o.dampedPanY.addForce(o.DRAG_CONSTRAINT&o.AXIS.PITCH?n.dist[1]:0)}mouseDragRotate(){var n=this,o=this.cam,p=n.curr[0],q=n.curr[1],r=n.dist[0],u=n.dist[1],v=2*Math.min(Math.max((p-o.viewport[0])/o.viewport[2],0),1)-1,A=2*Math.min(Math.max((q-o.viewport[1])/o.viewport[3],0),1)-1;o.DRAG_CONSTRAINT&o.AXIS.YAW&&o.dampedRotY.addForce(+r*(1-A*A)),o.DRAG_CONSTRAINT&o.AXIS.PITCH&&o.dampedRotX.addForce(-u*(1-v*v)),o.DRAG_CONSTRAINT&o.AXIS.ROLL&&(o.dampedRotZ.addForce(-r*A),o.dampedRotZ.addForce(+u*v))}getZoomMult(){return this.state.distance*this.scale_zoom}getPanMult(){return this.state.distance*this.scale_pan}getRotationMult(){return Math.pow(Math.log10(1+this.state.distance),0.5)*this.scale_rotation}zoom(n){var o=this.cam,p=o.state.distance+n;p<o.distance_min&&(p=o.distance_min,o.dampedZoom.stop()),p>o.distance_max&&(p=o.distance_max,o.dampedZoom.stop()),o.state.distance=p}panX(n){var o=this.cam.state;if(n){var p=j.applyToVec3(o.rotation,[n,0,0]);l.add(o.center,p,o.center)}}panY(n){var o=this.cam.state;if(n){var p=j.applyToVec3(o.rotation,[0,n,0]);l.add(o.center,p,o.center)}}pan(n){this.cam.panX(n),this.cam.panY(n)}rotateX(n){this.cam.rotate([1,0,0],n)}rotateY(n){this.cam.rotate([0,1,0],n)}rotateZ(n){this.cam.rotate([0,0,1],n)}rotate(n,o){var p=this.cam.state;if(o){var q=j.create({axis:n,angle:o});j.applyToRotation(p.rotation,q,p.rotation)}}setInterpolatedDistance(n,o,p){this.cam.state.distance=k.mix(n,o,k.smoothstep(p))}setInterpolatedCenter(n,o,p){this.cam.state.center=l.mix(n,o,k.smoothstep(p))}setInterpolatedRotation(n,o,p){this.cam.state.rotation=j.slerp(n,o,p)}setDistanceMin(n){this.distance_min=Math.max(n,this.distance_min_limit),this.zoom(0)}setDistanceMax(n){this.distance_max=n,this.zoom(0)}setDistance(n,o){this.timedzoom.start(this.state.distance,n,o,[this.dampedZoom])}getDistance(){return this.state.distance}setCenter(n,o){this.timedPan.start(this.state.center,n,o,[this.dampedPanX,this.dampedPanY])}getCenter(){return this.state.center}setRotation(n,o){this.timedRot.start(this.state.rotation,n,o,[this.dampedRotX,this.dampedRotY,this.dampedRotZ])}getRotation(){return this.state.rotation}getPosition(n){var o=this.cam,p=o.state;return n=l.assert(n),j.applyToVec3(p.rotation,o.LOOK,n),l.mult(n,p.distance,n),l.add(n,p.center,n),n}getUpVector(n){var o=this.cam,p=o.state;return n=l.assert(n),j.applyToVec3(p.rotation,o.UP,n),n}getState(){return this.state.copy()}setState(n,o){n&&(this.setDistance(n.distance,o),this.setCenter(n.center,o),this.setRotation(n.rotation,o))}pushState(){return this.state_pushed=this.getState()}popState(n){this.setState(this.state_pushed,n)}pushResetState(){return this.state_reset=this.getState()}reset(n){this.setState(this.state_reset,n)}setRotationScale(n){this.scale_rotation=n}setPanScale(n){this.scale_pan=n}setZoomScale(n){this.scale_zoom=n}getRotationScale(){return this.scale_rotation}getPanScale(){return this.scale_pan}getZoomScale(){return this.scale_zoom}getWheelScale(){return this.scale_zoomwheel}setWheelScale(n){this.scale_zoomwheel=n}setDamping(n){this.dampedZoom.damping=n,this.dampedPanX.damping=n,this.dampedPanY.damping=n,this.dampedRotX.damping=n,this.dampedRotY.damping=n,this.dampedRotZ.damping=n}setDefaultInterpolationTime(n){this.default_interpolation_time=n}getDefaultInterpolationTime(){return this.default_interpolation_time}setRotationConstraint(n,o,p){var q=this.cam;q.FIXED_CONSTRAINT=0,q.FIXED_CONSTRAINT|=n?q.AXIS.YAW:0,q.FIXED_CONSTRAINT|=o?q.AXIS.PITCH:0,q.FIXED_CONSTRAINT|=p?q.AXIS.ROLL:0}beginHUD(n,o,p){var q=this.cam;if(n=n||q.renderer,!!n){n.push();var r=n.drawingContext,o=void 0===o?n.width:o,p=void 0===p?n.height:p,u=Number.MAX_VALUE;r.flush(),r.disable(r.DEPTH_TEST),this.pushed_uMVMatrix=n.uMVMatrix.copy(),this.pushed_uPMatrix=n.uPMatrix.copy(),n.resetMatrix(),n.ortho(0,o,-p,0,-u,+u)}}endHUD(n){var o=this.cam;if(n=n||o.renderer,!!n){var p=n.drawingContext;p.flush(),n.uMVMatrix.set(this.pushed_uMVMatrix),n.uPMatrix.set(this.pushed_uPMatrix),p.enable(p.DEPTH_TEST),n.pop()}}},g=class{constructor(n,o){this.cam=n,this.value=0,this.damping=0.85,this.action=o}addForce(n){this.value+=n}update(){var n=1e-6<this.value*this.value;return n?(this.action(this.value),this.value*=this.damping):this.stop(),n}stop(){this.value=0}},i=class{constructor(n,o){this.cam=n,this.action=o}start(n,o,p,q){for(var r in q)q[r].stop();this.valA=n,this.valB=o,this.duration=p===void 0?this.cam.default_interpolation_time:p,this.timer=new Date().getTime(),this.active=0<this.duration,this.active||this.interpolate(1)}update(){if(this.active){var n=(new Date().getTime()-this.timer)/this.duration;0.995<n?(this.interpolate(1),this.stop()):this.interpolate(n)}}interpolate(n){this.action(this.valA,this.valB,n)}stop(){this.active=!1}},j={assert:function(n){return n===void 0||n.constructor!==Array?[1,0,0,0]:n},identity:function(){return[1,0,0,0]},applyToVec3:function(n,o,p){var q=o[0],r=o[1],u=o[2],v=n[0],A=n[1],B=n[2],C=n[3],D=A*q+B*r+C*u;return p=l.assert(p),p[0]=2*(v*(q*v-(B*u-C*r))+D*A)-q,p[1]=2*(v*(r*v-(C*q-A*u))+D*B)-r,p[2]=2*(v*(u*v-(A*r-B*q))+D*C)-u,p},applyToRotation(n,o,p){var q=n[0],r=n[1],u=n[2],v=n[3],A=o[0],B=o[1],C=o[2],D=o[3];return p=j.assert(p),p[0]=A*q-(B*r+C*u+D*v),p[1]=B*q+A*r+(C*v-D*u),p[2]=C*q+A*u+(D*r-B*v),p[3]=D*q+A*v+(B*u-C*r),p},slerp:function(n,o,p,q){var r=n[0],u=n[1],v=n[2],A=n[3],B=o[0],C=o[1],D=o[2],E=o[3],F=r*B+u*C+v*D+A*E;0>F&&(B=-B,C=-C,D=-D,E=-E,F=-F);var I,J,G=Math.acos(F),H=Math.sqrt(1-F*F);return 1e-3<H?(I=Math.sin((1-p)*G)/H,J=Math.sin(p*G)/H):(I=1-p,J=p),q=j.assert(q),q[0]=I*r+J*B,q[1]=I*u+J*C,q[2]=I*v+J*D,q[3]=I*A+J*E,j.create({rotation:q,normalize:!0},q)},create:function(n,o){if(o=j.assert(o),n.axis){var p=n.axis,q=n.angle,r=l.mag(p);if(0==r)return;var u=-0.5*q,v=Math.sin(u)/r;return o[0]=Math.cos(u),o[1]=v*p[0],o[2]=v*p[1],o[3]=v*p[2],o}if(n.rotation){if(o[0]=n.rotation[0],o[1]=n.rotation[1],o[2]=n.rotation[2],o[3]=n.rotation[3],n.normalize){var A=1/Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]+o[3]*o[3]);o[0]*=A,o[1]*=A,o[2]*=A,o[3]*=A}return o}if(n.angles_xyz){var B=-0.5*n.angles_xyz[0],C=-0.5*n.angles_xyz[1],D=-0.5*n.angles_xyz[2],E=[Math.cos(B),Math.sin(B),0,0],F=[Math.cos(C),0,Math.sin(C),0],G=[Math.cos(D),0,0,Math.sin(D)];return j.applyToRotation(F,G,o),j.applyToRotation(E,o,o),o}}},k={mix:function(n,o,p){return n*(1-p)+o*p},smoothstep:function(n){return n*n*(3-2*n)},smootherstep:function(){return x*x*x*(x*(6*x-15)+10)}},l={assert:function(n){return n===void 0||n.constructor!==Array?[0,0,0]:n},isScalar:function(n){return n!==void 0&&n.constructor!==Array},add:function(n,o,p){return p=this.assert(p),this.isScalar(o)?(p[0]=n[0]+o,p[1]=n[1]+o,p[2]=n[2]+o):(p[0]=n[0]+o[0],p[1]=n[1]+o[1],p[2]=n[2]+o[2]),p},mult:function(n,o,p){return p=this.assert(p),this.isScalar(o)?(p[0]=n[0]*o,p[1]=n[1]*o,p[2]=n[2]*o):(p[0]=n[0]*o[0],p[1]=n[1]*o[1],p[2]=n[2]*o[2]),p},magSq:function(n){return n[0]*n[0]+n[1]*n[1]+n[2]*n[2]},mag:function(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2])},dot:function(n,o){return n[0]*o[0]+n[1]*o[1]+n[2]*o[2]},cross:function(n,o,p){return p=this.assert(p),p[0]=n[1]*o[2]-n[2]*o[1],p[1]=n[2]*o[0]-n[0]*o[2],p[2]=n[0]*o[1]-n[1]*o[0],p},angle:function(n,o){var p=this.mag(n)*this.mag(o);if(0==p)return 0;var q=this.dot(n,o),r=0.9999*p;if(q<-r||q>r){var u=this.cross(n,o);return 0<=q?Math.asin(this.mag(u)/p):Math.PI-Math.asin(this.mag(u)/p)}return Math.acos(q/p)},mix(n,o,p,q){return q=this.assert(q),q[0]=k.mix(n[0],o[0],p),q[1]=k.mix(n[1],o[1],p),q[2]=k.mix(n[2],o[2],p),q}};f.INFO=e,Object.freeze(e),c.EasyCam=f,c.DampedAction=g,c.Interpolation=i,c.Rotation=j,c.Vec3=l,c.Scalar=k,p5&&(!p5.prototype.hasOwnProperty("glInfo")&&(p5.prototype.glInfo=function(){return this._renderer.glInfo.apply(this._renderer,arguments)},p5.RendererGL.prototype.glInfo=function(){var n=this.drawingContext,o={};o.gl=this.drawingContext;var p=n.getExtension("WEBGL_debug_renderer_info");return p&&(o.gpu_renderer=n.getParameter(p.UNMASKED_RENDERER_WEBGL),o.gpu_vendor=n.getParameter(p.UNMASKED_VENDOR_WEBGL)),o.wgl_renderer=n.getParameter(n.RENDERER),o.wgl_version=n.getParameter(n.VERSION),o.wgl_glsl=n.getParameter(n.SHADING_LANGUAGE_VERSION),o.wgl_vendor=n.getParameter(n.VENDOR),o}),!p5.prototype.hasOwnProperty("createEasyCam")&&(p5.prototype.createEasyCam=function(){var n=this._renderer,o=arguments[0];return arguments[0]instanceof p5.RendererGL&&(n=arguments[0],o=arguments[1]),new c.EasyCam(n,o)}),p5.prototype.ortho=function(){return this._renderer.ortho.apply(this._renderer,arguments),this},p5.RendererGL.prototype.ortho=function(n,o,p,q,r,u){n===void 0&&(n=-this.width/2),o===void 0&&(o=+this.width/2),p===void 0&&(p=-this.height/2),q===void 0&&(q=+this.height/2),r===void 0&&(r=0),u===void 0&&(u=Math.max(this.width,this.height));var v=o-n,A=q-p,B=u-r,F=-(o+n)/v,G=-(q+p)/A,H=-(u+r)/B;this.uPMatrix=p5.Matrix.identity(),this.uPMatrix.set(2/v,0,0,0,0,-(2/A),0,0,0,0,-2/B,0,F,G,H,1),this._curCamera="custom"})})(Dw);